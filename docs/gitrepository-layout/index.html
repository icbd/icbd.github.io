<!DOCTYPE html>
<html>
  <head>
  <title>Git 仓库结构布局 – CBD Blog – 好记性不如烂笔头,站在岸上学不会游泳</title>
      <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="https://git-scm.com/docs/gitrepository-layout

Git 仓库有两种风格:


  位于工作目录下的 .git;
  独立的 &lt;project&gt;.git 目录, 这是一个裸仓库, 没有自己的工作区, 用于跟其他人同步历史记录.


注意: .git 也可以是工作区下的一个普通文件, 其内容是 gitdir: &lt;path&gt; 来指向仓库的实际目录.
这个机制常用在子模块的 checkout, 为的是让父项目 git checkout 到一个不含子模块的分支的时候,
不会丢失子模块的仓库, 因为 checkout 会清空整个子模块的工作区.

Git 仓库中的常见元素.

objects

该目录为仓库的对象库.
  通常来说, 每个对象都指向存储内的一个对象, 但也有几个例外.

通过浅 clone , 能获得一个可用但不完整的本地仓库;
  可以借助 objects/info/alternates 或者 $GIT_ALTERNATE_OBJECT_DIRECTORIES 机制从其他对象库里”借”一些对象;

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/objects` .


objects/[0-9a-f][0-9a-f]

对象文件.   所有的对象会被分摊到 256 个子目录中, 目录的名字取自对象的 SHA1 字符串的前两位.   从这里查找对象一般称作 "拆箱" (unpacked / loose) 对象.


objects/pack

该目录存储压缩的对象和索引, 以便随机访问.

objects/info

该目录保存对象库的额外信息.

objects/info/packs

该文件为哑传输记录对象库可用的打包.
  如果仓库通过哑传输发布, 一旦打包被新加或者移除, 都应该执行 git update-server-info 来更新该文件.
  git repack 会默认这样做.

objects/info/alternates

该文件记录对象库中所 "借" 对象的来源, 每条记录占一行.
不仅原生的 Git 工具在本地使用它, HTTP 访问的也会远程访问它.
一般使用相对路径. 如果是绝对路径, 需要满足跟 web URL 相匹配.


objects/info/http-alternates

该文件记录了对象库中所 "借" 对象的来源, 这些记录是 URL 的形式.


refs

引用存储在这个目录的子目录下.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/refs` .


refs/heads/name

该文件记录分支最上面那个 commit 对象.


refs/tags/name

该文件记录 tag 指向的对象. 


refs/remotes/name

该文件远端分支最上面的 commit 对象.


refs/replace/&lt;obj-sha1&gt;

records the SHA-1 of the object that replaces `&lt;obj-sha1&gt;`.
This is similar to info/grafts and is internally used and
maintained by linkgit:git-replace[1]. Such refs can be exchanged
between repositories while grafts are not.


packed-refs

records the same information as refs/heads/, refs/tags/,
and friends record in a more efficient way.  See
linkgit:git-pack-refs[1]. This file is ignored if $GIT_COMMON_DIR
is set and "$GIT_COMMON_DIR/packed-refs" will be used instead.


HEAD

改文件是当前活跃分支 `refs/heads/` 的符号引用.

当仓库没有关联工作区时, 它没有实际的意义, 但对于一个合法的仓库来说, HEAD 是必须存在的.

上层命令可能会用它来猜测默认分支(通常是 "master").

HEAD 也能直接对应一个 commit, 也就是 "分离头指针".


config

仓库的配置文件.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/config` .


config.worktree

Working directory specific configuration file for the main
working directory in multiple working directory setup


branches

已过时.


hooks

该目录保存 Git 命令的自定义钩子.
所有的钩子默认关闭. 移除文件名中的 `.sample` 来启用钩子.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/hooks` .


common

When multiple working trees are used, most of files in
$GIT_DIR are per-worktree with a few known exceptions. All
files under 'common' however will be shared between all
working trees.


index

仓库索引. 
通常不会出现在裸仓库中.


sharedindex.

共享索引.
只在分离索引模式下生效.


info

改目录仓储仓库的额外信息.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/info` .


info/refs

该文件帮助哑传输发现仓库中可用的引用.
一旦该仓库以哑传输发布, 每当标签或分支有创建和修改, 都应当执行 `git update-server-info` 来重新生成该文件.

当你 `git push` 仓库后, `git-receive-pack` 会调用 `hooks/update` 钩子来完成这个操作.


info/grafts

该文件记录伪造的 commit 祖先信息. 

已过时.


info/exclude

该文件保存排除的匹配模式列表.
`.gitignore` 逐个目录地忽略文件.
'git status', 'git add', 'git rm' and 'git clean' 检查它, 但 Git 核心命令不检查.


info/attributes

Defines which attributes to assign to a path, similar to per-directory `.gitattributes` files.


info/sparse-checkout

该文件保存稀疏 checkout 的匹配模式.


remotes

保存远端仓库的 URL 和 默认引用名称.
属于历史遗留, 现代仓库中很少见了.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略这个目录, 使用 `$GIT_COMMON_DIR/remotes`.


logs

该目录记录引用的变更.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/logs` .


logs/refs/heads/name

分支的变更.


logs/refs/tags/name

tag 的变更.


shallow

用于浅 clone , 跟 `info/grafts` 类似.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该文件, 使用 `$GIT_COMMON_DIR/shallow` .


commondir

当文件存在时, 如果环境变量 `$GIT_COMMON_DIR` 没有被显示地设置过, 那么就根据该文件的值来设置 `$GIT_COMMON_DIR`.

如果保存的路径是相对路径, 则相对于 `$GIT_DIR` .


modules

该目录保存子模块.


worktrees

该目录保存了工作区的数据.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略这个目录, 使用 `$GIT_COMMON_DIR/worktrees`.


worktrees//gitdir

该文件保存了 `.git` 的绝对路径.

用于检查链接的存储库是否已被手动删除了, 并且不再需要保留此目录.
每当链接的仓库被访问, 就应当更新该文件的 mtime .


worktrees//locked

如果该文件存在, 那么对应的工作区不可用. 
同时, 会阻止自动或手动触发的 prune .
它的内容是字符串, 解释仓库被锁定的原因.


worktrees//config.worktree

该文件保存了工作区特定的配置.

" />
    <meta property="og:description" content="https://git-scm.com/docs/gitrepository-layout

Git 仓库有两种风格:


  位于工作目录下的 .git;
  独立的 &lt;project&gt;.git 目录, 这是一个裸仓库, 没有自己的工作区, 用于跟其他人同步历史记录.


注意: .git 也可以是工作区下的一个普通文件, 其内容是 gitdir: &lt;path&gt; 来指向仓库的实际目录.
这个机制常用在子模块的 checkout, 为的是让父项目 git checkout 到一个不含子模块的分支的时候,
不会丢失子模块的仓库, 因为 checkout 会清空整个子模块的工作区.

Git 仓库中的常见元素.

objects

该目录为仓库的对象库.
  通常来说, 每个对象都指向存储内的一个对象, 但也有几个例外.

通过浅 clone , 能获得一个可用但不完整的本地仓库;
  可以借助 objects/info/alternates 或者 $GIT_ALTERNATE_OBJECT_DIRECTORIES 机制从其他对象库里”借”一些对象;

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/objects` .


objects/[0-9a-f][0-9a-f]

对象文件.   所有的对象会被分摊到 256 个子目录中, 目录的名字取自对象的 SHA1 字符串的前两位.   从这里查找对象一般称作 "拆箱" (unpacked / loose) 对象.


objects/pack

该目录存储压缩的对象和索引, 以便随机访问.

objects/info

该目录保存对象库的额外信息.

objects/info/packs

该文件为哑传输记录对象库可用的打包.
  如果仓库通过哑传输发布, 一旦打包被新加或者移除, 都应该执行 git update-server-info 来更新该文件.
  git repack 会默认这样做.

objects/info/alternates

该文件记录对象库中所 "借" 对象的来源, 每条记录占一行.
不仅原生的 Git 工具在本地使用它, HTTP 访问的也会远程访问它.
一般使用相对路径. 如果是绝对路径, 需要满足跟 web URL 相匹配.


objects/info/http-alternates

该文件记录了对象库中所 "借" 对象的来源, 这些记录是 URL 的形式.


refs

引用存储在这个目录的子目录下.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/refs` .


refs/heads/name

该文件记录分支最上面那个 commit 对象.


refs/tags/name

该文件记录 tag 指向的对象. 


refs/remotes/name

该文件远端分支最上面的 commit 对象.


refs/replace/&lt;obj-sha1&gt;

records the SHA-1 of the object that replaces `&lt;obj-sha1&gt;`.
This is similar to info/grafts and is internally used and
maintained by linkgit:git-replace[1]. Such refs can be exchanged
between repositories while grafts are not.


packed-refs

records the same information as refs/heads/, refs/tags/,
and friends record in a more efficient way.  See
linkgit:git-pack-refs[1]. This file is ignored if $GIT_COMMON_DIR
is set and "$GIT_COMMON_DIR/packed-refs" will be used instead.


HEAD

改文件是当前活跃分支 `refs/heads/` 的符号引用.

当仓库没有关联工作区时, 它没有实际的意义, 但对于一个合法的仓库来说, HEAD 是必须存在的.

上层命令可能会用它来猜测默认分支(通常是 "master").

HEAD 也能直接对应一个 commit, 也就是 "分离头指针".


config

仓库的配置文件.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/config` .


config.worktree

Working directory specific configuration file for the main
working directory in multiple working directory setup


branches

已过时.


hooks

该目录保存 Git 命令的自定义钩子.
所有的钩子默认关闭. 移除文件名中的 `.sample` 来启用钩子.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/hooks` .


common

When multiple working trees are used, most of files in
$GIT_DIR are per-worktree with a few known exceptions. All
files under 'common' however will be shared between all
working trees.


index

仓库索引. 
通常不会出现在裸仓库中.


sharedindex.

共享索引.
只在分离索引模式下生效.


info

改目录仓储仓库的额外信息.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/info` .


info/refs

该文件帮助哑传输发现仓库中可用的引用.
一旦该仓库以哑传输发布, 每当标签或分支有创建和修改, 都应当执行 `git update-server-info` 来重新生成该文件.

当你 `git push` 仓库后, `git-receive-pack` 会调用 `hooks/update` 钩子来完成这个操作.


info/grafts

该文件记录伪造的 commit 祖先信息. 

已过时.


info/exclude

该文件保存排除的匹配模式列表.
`.gitignore` 逐个目录地忽略文件.
'git status', 'git add', 'git rm' and 'git clean' 检查它, 但 Git 核心命令不检查.


info/attributes

Defines which attributes to assign to a path, similar to per-directory `.gitattributes` files.


info/sparse-checkout

该文件保存稀疏 checkout 的匹配模式.


remotes

保存远端仓库的 URL 和 默认引用名称.
属于历史遗留, 现代仓库中很少见了.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略这个目录, 使用 `$GIT_COMMON_DIR/remotes`.


logs

该目录记录引用的变更.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/logs` .


logs/refs/heads/name

分支的变更.


logs/refs/tags/name

tag 的变更.


shallow

用于浅 clone , 跟 `info/grafts` 类似.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该文件, 使用 `$GIT_COMMON_DIR/shallow` .


commondir

当文件存在时, 如果环境变量 `$GIT_COMMON_DIR` 没有被显示地设置过, 那么就根据该文件的值来设置 `$GIT_COMMON_DIR`.

如果保存的路径是相对路径, 则相对于 `$GIT_DIR` .


modules

该目录保存子模块.


worktrees

该目录保存了工作区的数据.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略这个目录, 使用 `$GIT_COMMON_DIR/worktrees`.


worktrees//gitdir

该文件保存了 `.git` 的绝对路径.

用于检查链接的存储库是否已被手动删除了, 并且不再需要保留此目录.
每当链接的仓库被访问, 就应当更新该文件的 mtime .


worktrees//locked

如果该文件存在, 那么对应的工作区不可用. 
同时, 会阻止自动或手动触发的 prune .
它的内容是字符串, 解释仓库被锁定的原因.


worktrees//config.worktree

该文件保存了工作区特定的配置.

" />
    
    <meta name="author" content="CBD Blog" />

    
    <meta property="og:title" content="Git 仓库结构布局" />
    <meta property="twitter:title" content="Git 仓库结构布局" />
    
  <link rel="stylesheet" type="text/css" href="/style.css" />
  <link rel="alternate" type="application/rss+xml" title="CBD Blog - 好记性不如烂笔头,站在岸上学不会游泳" href="/feed.xml" />
  <link rel="shortcut icon" href="/images/avatar.jpg">
<!--  <script src="https://lib.baomitu.com/gitalk/1.6.2/gitalk.min.js"></script>-->
  <script src="https://lib.baomitu.com/feather-icons/latest/feather.min.js"></script>
  <script type="text/javascript" async src="https://lib.baomitu.com/mathjax/2.7.7/MathJax.js?...">
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
  </script>
  <script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?9dfbb5850b35a184a60c9a4a1b08d7e3";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

  <meta name="google-site-verification" content="ZqVpjmLHnwuJ0qbh4QrpcofglQe6XEjjF7X1AB7yXus" />
</head>

  <body>
    <div class="wrapper-sidebar">
  <header class="sidebar clearfix">
    <div class="site-info">
      
        <a href="/" class="site-avatar"><img src="/images/avatar.jpg" /></a>
       
      <h1 class="site-name"><a href="/">CBD Blog</a></h1>
      <p class="site-description">好记性不如烂笔头,站在岸上学不会游泳</p>
    </div>
  </header>

  <div class="navlist">
    <nav>
      
      
      <a href="/">首页</a>
      
      
      
      <a href="/archive">归档</a>
      
      
      
      <a href="/about">关于</a>
      
      
    </nav>
  </div>

  <div class="wrapper-footer-desktop">
    <footer class="footer">
      <!-- Refer to https://codepen.io/ruandre/pen/howFi -->
<ul class="svg-icon">

  
  
  

  

  
  <li><a href="mailto:wwwicbd@gmail.com" class="icon-8 email" title="Email"><svg viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg><!--[if lt IE 9]><em>Email</em><![endif]--></a></li>
  

  

  

  
  <li><a href="https://github.com/icbd" class="icon-13 github" title="GitHub"><svg viewBox="0 0 512 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg><!--[if lt IE 9]><em>GitHub</em><![endif]--></a></li>
  

  

  

  

  
  <li><a href="/feed.xml" class="icon-21 rss" title="RSS"><svg viewBox="0 0 512 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM112 416c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm157.533 0h-34.335c-6.011 0-11.051-4.636-11.442-10.634-5.214-80.05-69.243-143.92-149.123-149.123-5.997-.39-10.633-5.431-10.633-11.441v-34.335c0-6.535 5.468-11.777 11.994-11.425 110.546 5.974 198.997 94.536 204.964 204.964.352 6.526-4.89 11.994-11.425 11.994zm103.027 0h-34.334c-6.161 0-11.175-4.882-11.427-11.038-5.598-136.535-115.204-246.161-251.76-251.76C68.882 152.949 64 147.935 64 141.774V107.44c0-6.454 5.338-11.664 11.787-11.432 167.83 6.025 302.21 141.191 308.205 308.205.232 6.449-4.978 11.787-11.432 11.787z"/></svg><!--[if lt IE 9]><em>RSS</em><![endif]--></a></li>
  

  

  

  
  <li><a href="https://www.twitter.com/CbdFocus" class="icon-26 twitter" title="Twitter"><svg viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg><!--[if lt IE 9]><em>Twitter</em><![endif]--></a></li>
  

  

</ul>



<p>Copyright (c) 2020 CBD Blog</p>

    </footer>
  </div>
</div>

    
      <aside class="toc">
        <ul>
  <li><a href="#">Git 仓库结构布局</a>
    <ul>
      <li><a href="#objects">objects</a></li>
      <li><a href="#objects0-9a-f0-9a-f">objects/[0-9a-f][0-9a-f]</a></li>
      <li><a href="#objectspack">objects/pack</a></li>
      <li><a href="#objectsinfo">objects/info</a></li>
      <li><a href="#objectsinfopacks">objects/info/packs</a></li>
      <li><a href="#objectsinfoalternates">objects/info/alternates</a></li>
      <li><a href="#objectsinfohttp-alternates">objects/info/http-alternates</a></li>
      <li><a href="#refs">refs</a></li>
      <li><a href="#refsheadsname">refs/heads/<code class="language-plaintext highlighter-rouge">name</code></a></li>
      <li><a href="#refstagsname">refs/tags/<code class="language-plaintext highlighter-rouge">name</code></a></li>
      <li><a href="#refsremotesname">refs/remotes/<code class="language-plaintext highlighter-rouge">name</code></a></li>
      <li><a href="#refsreplaceobj-sha1">refs/replace/<code class="language-plaintext highlighter-rouge">&lt;obj-sha1&gt;</code></a></li>
      <li><a href="#packed-refs">packed-refs</a></li>
      <li><a href="#head">HEAD</a></li>
      <li><a href="#config">config</a></li>
      <li><a href="#configworktree">config.worktree</a></li>
      <li><a href="#branches">branches</a></li>
      <li><a href="#hooks">hooks</a></li>
      <li><a href="#common">common</a></li>
      <li><a href="#index">index</a></li>
      <li><a href="#sharedindex">sharedindex.<SHA-1></SHA-1></a></li>
      <li><a href="#info">info</a></li>
      <li><a href="#inforefs">info/refs</a></li>
      <li><a href="#infografts">info/grafts</a></li>
      <li><a href="#infoexclude">info/exclude</a></li>
      <li><a href="#infoattributes">info/attributes</a></li>
      <li><a href="#infosparse-checkout">info/sparse-checkout</a></li>
      <li><a href="#remotes">remotes</a></li>
      <li><a href="#logs">logs</a></li>
      <li><a href="#logsrefsheadsname">logs/refs/heads/<code class="language-plaintext highlighter-rouge">name</code></a></li>
      <li><a href="#logsrefstagsname">logs/refs/tags/<code class="language-plaintext highlighter-rouge">name</code></a></li>
      <li><a href="#shallow">shallow</a></li>
      <li><a href="#commondir">commondir</a></li>
      <li><a href="#modules">modules</a></li>
      <li><a href="#worktrees">worktrees</a></li>
      <li><a href="#worktreesgitdir">worktrees/<id>/gitdir</id></a></li>
      <li><a href="#worktreeslocked">worktrees/<id>/locked</id></a></li>
      <li><a href="#worktreesconfigworktree">worktrees/<id>/config.worktree</id></a></li>
    </ul>
  </li>
</ul>
      </aside>
    

    <div id="main" role="main" class="wrapper-content">
      <div class="container">
        <article class="posts">
  <h1>Git 仓库结构布局</h1>

  <div clsss="meta">
    <span class="author">
      
    </span>

    <span class="date">
      2022-02-21
    </span>

    <ul class="tag">
      
      <li>
        <a href="https://icbd.github.io/tags#Git">
          Git
        </a>
      </li>
      
    </ul>
  </div>

  <div class="entry">
    <p><a href="https://git-scm.com/docs/gitrepository-layout">https://git-scm.com/docs/gitrepository-layout</a></p>

<p>Git 仓库有两种风格:</p>

<ul>
  <li>位于工作目录下的 <code class="language-plaintext highlighter-rouge">.git</code>;</li>
  <li>独立的 <code class="language-plaintext highlighter-rouge">&lt;project&gt;.git</code> 目录, 这是一个裸仓库, 没有自己的工作区, 用于跟其他人同步历史记录.</li>
</ul>

<p><em>注意</em>: <code class="language-plaintext highlighter-rouge">.git</code> 也可以是工作区下的一个普通文件, 其内容是 <code class="language-plaintext highlighter-rouge">gitdir: &lt;path&gt;</code> 来指向仓库的实际目录.
这个机制常用在子模块的 checkout, 为的是让父项目 <code class="language-plaintext highlighter-rouge">git checkout</code> 到一个不含子模块的分支的时候,
不会丢失子模块的仓库, 因为 <code class="language-plaintext highlighter-rouge">checkout</code> 会清空整个子模块的工作区.</p>

<p>Git 仓库中的常见元素.</p>

<h3 id="objects">objects</h3>

<p>该目录为仓库的对象库.
  通常来说, 每个对象都指向存储内的一个对象, 但也有几个例外.</p>

<p>通过浅 clone , 能获得一个可用但不完整的本地仓库;
  可以借助 <code class="language-plaintext highlighter-rouge">objects/info/alternates</code> 或者 <code class="language-plaintext highlighter-rouge">$GIT_ALTERNATE_OBJECT_DIRECTORIES</code> 机制从其他对象库里”借”一些对象;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/objects` .
</code></pre></div></div>

<h2 id="objects0-9a-f0-9a-f">objects/[0-9a-f][0-9a-f]</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>对象文件.   所有的对象会被分摊到 256 个子目录中, 目录的名字取自对象的 SHA1 字符串的前两位.   从这里查找对象一般称作 "拆箱" (unpacked / loose) 对象.
</code></pre></div></div>

<h2 id="objectspack">objects/pack</h2>

<p>该目录存储压缩的对象和索引, 以便随机访问.</p>

<h2 id="objectsinfo">objects/info</h2>

<p>该目录保存对象库的额外信息.</p>

<h2 id="objectsinfopacks">objects/info/packs</h2>

<p>该文件为哑传输记录对象库可用的打包.
  如果仓库通过哑传输发布, 一旦打包被新加或者移除, 都应该执行 <code class="language-plaintext highlighter-rouge">git update-server-info</code> 来更新该文件.
  <code class="language-plaintext highlighter-rouge">git repack</code> 会默认这样做.</p>

<h2 id="objectsinfoalternates">objects/info/alternates</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件记录对象库中所 "借" 对象的来源, 每条记录占一行.
不仅原生的 Git 工具在本地使用它, HTTP 访问的也会远程访问它.
一般使用相对路径. 如果是绝对路径, 需要满足跟 web URL 相匹配.
</code></pre></div></div>

<h2 id="objectsinfohttp-alternates">objects/info/http-alternates</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件记录了对象库中所 "借" 对象的来源, 这些记录是 URL 的形式.
</code></pre></div></div>

<h2 id="refs">refs</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>引用存储在这个目录的子目录下.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/refs` .
</code></pre></div></div>

<h2 id="refsheadsname">refs/heads/<code class="language-plaintext highlighter-rouge">name</code></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件记录分支最上面那个 commit 对象.
</code></pre></div></div>

<h2 id="refstagsname">refs/tags/<code class="language-plaintext highlighter-rouge">name</code></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件记录 tag 指向的对象. 
</code></pre></div></div>

<h2 id="refsremotesname">refs/remotes/<code class="language-plaintext highlighter-rouge">name</code></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件远端分支最上面的 commit 对象.
</code></pre></div></div>

<h2 id="refsreplaceobj-sha1">refs/replace/<code class="language-plaintext highlighter-rouge">&lt;obj-sha1&gt;</code></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>records the SHA-1 of the object that replaces `&lt;obj-sha1&gt;`.
This is similar to info/grafts and is internally used and
maintained by linkgit:git-replace[1]. Such refs can be exchanged
between repositories while grafts are not.
</code></pre></div></div>

<h2 id="packed-refs">packed-refs</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>records the same information as refs/heads/, refs/tags/,
and friends record in a more efficient way.  See
linkgit:git-pack-refs[1]. This file is ignored if $GIT_COMMON_DIR
is set and "$GIT_COMMON_DIR/packed-refs" will be used instead.
</code></pre></div></div>

<h2 id="head">HEAD</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>改文件是当前活跃分支 `refs/heads/` 的符号引用.

当仓库没有关联工作区时, 它没有实际的意义, 但对于一个合法的仓库来说, HEAD 是必须存在的.

上层命令可能会用它来猜测默认分支(通常是 "master").

HEAD 也能直接对应一个 commit, 也就是 "分离头指针".
</code></pre></div></div>

<h2 id="config">config</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>仓库的配置文件.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/config` .
</code></pre></div></div>

<h2 id="configworktree">config.worktree</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Working directory specific configuration file for the main
working directory in multiple working directory setup
</code></pre></div></div>

<h2 id="branches">branches</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>已过时.
</code></pre></div></div>

<h2 id="hooks">hooks</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该目录保存 Git 命令的自定义钩子.
所有的钩子默认关闭. 移除文件名中的 `.sample` 来启用钩子.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/hooks` .
</code></pre></div></div>

<h2 id="common">common</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>When multiple working trees are used, most of files in
$GIT_DIR are per-worktree with a few known exceptions. All
files under 'common' however will be shared between all
working trees.
</code></pre></div></div>

<h2 id="index">index</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>仓库索引. 
通常不会出现在裸仓库中.
</code></pre></div></div>

<h2 id="sharedindex">sharedindex.<SHA-1></SHA-1></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>共享索引.
只在分离索引模式下生效.
</code></pre></div></div>

<h2 id="info">info</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>改目录仓储仓库的额外信息.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/info` .
</code></pre></div></div>

<h2 id="inforefs">info/refs</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件帮助哑传输发现仓库中可用的引用.
一旦该仓库以哑传输发布, 每当标签或分支有创建和修改, 都应当执行 `git update-server-info` 来重新生成该文件.

当你 `git push` 仓库后, `git-receive-pack` 会调用 `hooks/update` 钩子来完成这个操作.
</code></pre></div></div>

<h2 id="infografts">info/grafts</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件记录伪造的 commit 祖先信息. 

已过时.
</code></pre></div></div>

<h2 id="infoexclude">info/exclude</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件保存排除的匹配模式列表.
`.gitignore` 逐个目录地忽略文件.
'git status', 'git add', 'git rm' and 'git clean' 检查它, 但 Git 核心命令不检查.
</code></pre></div></div>

<h2 id="infoattributes">info/attributes</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Defines which attributes to assign to a path, similar to per-directory `.gitattributes` files.
</code></pre></div></div>

<h2 id="infosparse-checkout">info/sparse-checkout</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件保存稀疏 checkout 的匹配模式.
</code></pre></div></div>

<h2 id="remotes">remotes</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>保存远端仓库的 URL 和 默认引用名称.
属于历史遗留, 现代仓库中很少见了.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略这个目录, 使用 `$GIT_COMMON_DIR/remotes`.
</code></pre></div></div>

<h2 id="logs">logs</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该目录记录引用的变更.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该目录, 使用 `$GIT_COMMON_DIR/logs` .
</code></pre></div></div>

<h2 id="logsrefsheadsname">logs/refs/heads/<code class="language-plaintext highlighter-rouge">name</code></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>分支的变更.
</code></pre></div></div>

<h2 id="logsrefstagsname">logs/refs/tags/<code class="language-plaintext highlighter-rouge">name</code></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tag 的变更.
</code></pre></div></div>

<h2 id="shallow">shallow</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>用于浅 clone , 跟 `info/grafts` 类似.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略该文件, 使用 `$GIT_COMMON_DIR/shallow` .
</code></pre></div></div>

<h2 id="commondir">commondir</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>当文件存在时, 如果环境变量 `$GIT_COMMON_DIR` 没有被显示地设置过, 那么就根据该文件的值来设置 `$GIT_COMMON_DIR`.

如果保存的路径是相对路径, 则相对于 `$GIT_DIR` .
</code></pre></div></div>

<h2 id="modules">modules</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该目录保存子模块.
</code></pre></div></div>

<h2 id="worktrees">worktrees</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该目录保存了工作区的数据.

如果设置了环境变量 `$GIT_COMMON_DIR`, 则忽略这个目录, 使用 `$GIT_COMMON_DIR/worktrees`.
</code></pre></div></div>

<h2 id="worktreesgitdir">worktrees/<id>/gitdir</id></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件保存了 `.git` 的绝对路径.

用于检查链接的存储库是否已被手动删除了, 并且不再需要保留此目录.
每当链接的仓库被访问, 就应当更新该文件的 mtime .
</code></pre></div></div>

<h2 id="worktreeslocked">worktrees/<id>/locked</id></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>如果该文件存在, 那么对应的工作区不可用. 
同时, 会阻止自动或手动触发的 prune .
它的内容是字符串, 解释仓库被锁定的原因.
</code></pre></div></div>

<h2 id="worktreesconfigworktree">worktrees/<id>/config.worktree</id></h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>该文件保存了工作区特定的配置.
</code></pre></div></div>

  </div>

  
  
<script src="https://utteranc.es/client.js"
        repo="icbd/blogs"
        issue-term="pathname"
        label="utteranc"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

  
</article>

<div class="pagination">
  
    <span class="prev" >
      <a href="https://icbd.github.io/git-internal-objects/">
        ← 上一篇
      </a>
    </span>
  
  
    <span class="next" >
      <a href="https://icbd.github.io/git-cat-file-and-object-frame/">
        下一篇 →
      </a>
    </span>
  
</div>

      </div>
    </div>
  </body>

  
  <script>
    document.getElementById("main").classList.add("withtoc");
  </script>
  

  <div class="wrapper-footer-mobile">
    <footer class="footer">
      <!-- Refer to https://codepen.io/ruandre/pen/howFi -->
<ul class="svg-icon">

  
  
  

  

  
  <li><a href="mailto:wwwicbd@gmail.com" class="icon-8 email" title="Email"><svg viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg><!--[if lt IE 9]><em>Email</em><![endif]--></a></li>
  

  

  

  
  <li><a href="https://github.com/icbd" class="icon-13 github" title="GitHub"><svg viewBox="0 0 512 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg><!--[if lt IE 9]><em>GitHub</em><![endif]--></a></li>
  

  

  

  

  
  <li><a href="/feed.xml" class="icon-21 rss" title="RSS"><svg viewBox="0 0 512 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM112 416c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm157.533 0h-34.335c-6.011 0-11.051-4.636-11.442-10.634-5.214-80.05-69.243-143.92-149.123-149.123-5.997-.39-10.633-5.431-10.633-11.441v-34.335c0-6.535 5.468-11.777 11.994-11.425 110.546 5.974 198.997 94.536 204.964 204.964.352 6.526-4.89 11.994-11.425 11.994zm103.027 0h-34.334c-6.161 0-11.175-4.882-11.427-11.038-5.598-136.535-115.204-246.161-251.76-251.76C68.882 152.949 64 147.935 64 141.774V107.44c0-6.454 5.338-11.664 11.787-11.432 167.83 6.025 302.21 141.191 308.205 308.205.232 6.449-4.978 11.787-11.432 11.787z"/></svg><!--[if lt IE 9]><em>RSS</em><![endif]--></a></li>
  

  

  

  
  <li><a href="https://www.twitter.com/CbdFocus" class="icon-26 twitter" title="Twitter"><svg viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg><!--[if lt IE 9]><em>Twitter</em><![endif]--></a></li>
  

  

</ul>



<p>Copyright (c) 2020 CBD Blog</p>

    </footer>
</html>
